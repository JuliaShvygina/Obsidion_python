---
aliases:
  - потоки
  - процессы
  - асинхронность
  - много процессорность
  - многопоточность
  - gil
---
## Потоки и процессы в Python

**Синхронное** выполнение программы подразумевает последовательное выполнение операций. 
**Асинхронное** – предполагает возможность независимого выполнения задач.
**Конкурентность** предполагает выполнение нескольких задач одним исполнителем.
**Параллельность** предполагает параллельное выполнение задач разными исполнителями.

### **Несколько слов о *GIL***
Защищает от того, что первый поток неожиданно уснет, второй поток проснется и подменит данные. Все потоки, кроме текущего, спят и ждут GIL.

Для того, чтобы двигаться дальше необходимо сказать несколько слов о *GIL*. *GIL* —  это аббревиатура от *Global Interpreter Lock* – глобальная блокировка интерпретатора.
Суть *GIL* заключается в том, что выполнять байт код может только один поток. Это нужно для того, чтобы упростить работу с памятью (на уровне интерпретатора) и сделать комфортной разработку модулей на языке *C*.

Условно, все задачи можно разделить на **две** большие группы: 
* использующие процессор для своего выполнения, например, математические, их ещё называют *CPU-bound*;
* работающие с вводом выводом (диск, сеть и т.п.), такие задачи называют *IO-bound*.

Если вы запустили в одном интерпретаторе несколько потоков, которые в основном используют процессор, то скорее всего получите общее замедление работы, а не прирост производительности. Пока выполняется одна задача, остальные простаивают (из-за GIL), переключение происходит через определенные промежутки времени. Таким образом, в каждый конкретный момент времени, будет выполняться только один поток, несмотря на то, что у вас может быть многоядерный процессор (или многопроцессорный сервер), плюс ко всему, будет тратиться время на переключение между задачами. Если код в потоках в основном выполняет операции ввода-вывода, то в этом случае ситуация будет в вашу пользу.



## **Потоки в *Python***
**Поток** — последовательность операций, последовательностью выполнения которых управляет ОС.
У каждого процесса есть как минимум один поток, который главный. При этом программа может запускать дополнительные потоки. Все потоки выполнения в рамках одного процесса распределяют его ресурсы.
Проблема — особый порядок потоков, например, одновременно один поток меняет данные, а другой в это же время их читает.
Еще одна проблема — ограниченное количество потоков.


Потоки позволяют запустить выполнение нескольких задач в конкурентном режиме в рамках одного процесса интерпретатора. При этом, нужно помнить о _GIL_. Все потоки будут выполняться на одном _CPU_, даже если задачи могут выполняться параллельно. Поэтому есть такое правило, **если ваши задачи** в основном **потребляют ресурсы процессора,** то используйте **процессы**, если **ввод-вывод**, то **потоки** и другие инструменты асинхронного программирования.

## Асинхронность

**Асинхронность** (кооперативная многозадачность) — работает в рамках одного процесса и одного потока. Не блокирует поток выполнения, при ожидании переключается на обработку других действий.
Например, [[AsyncIO|AsyncIO]].