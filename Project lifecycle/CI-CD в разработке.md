---
aliases: [CI/CD, continious integration, continious delivery, continious development]
---
```py

```

# GitLab CI для непрерывной интеграции и доставки в production.
![](https://habrastorage.org/r/w1560/web/ca1/fce/04e/ca1fce04e3314111ac634a3b5d8b8dec.png)

Pipeline — это последовательность выполнения стадий _(здесь и далее в статье для термина stage использую перевод «стадия»)_, каждая из которых включает несколько задач _(здесь и далее в статье job — «задача»)_. От момента внесения изменений в код до выката в production приложение по очереди оказывается в руках разных команд — подобному тому, как это происходит на конвейере. Отсюда и возник термин pipeline _(«конвейер» — один из вариантов дословного перевода)_.

![](https://i.imgur.com/MUmtEzF.png)

Краткие пояснения по используемым стадиям:  
-   **build** — сборка приложения;
-   **testing** — автотесты;
-   **staging** — развёртывание приложения для разработчиков, DevOps, тестировщиков;
-   **pre-production** — развёртывание в «предварительный production» для команды тестировщиков;
-   **approve** — «предохранитель», благодаря которому релиз-инженер заказчика может отказать в развёртывании на production определённого тега;
-   **production** — развёртывание на production.

Начну с рассказа о пайплайне с точки зрения его использования — то, что можно назвать user story. Тут выяснится, что на самом деле пайплайна у нас даже два: укороченный для веток и полноценный для тегов. И вот как выглядят эти последовательности:  
 
1.  Разработчики выкладывают код приложения в ветки с префиксом _feature__, а DevOps-инженеры — код инфраструктуры в ветки с префиксом _infra__. Каждый git push в эти ветки запускает процесс сборки приложения (стадия **build**) и автоматические тесты (стадия **testing**).
2.  Задачи на следующих стадиях не вызываются автоматически, а определены как задачи с ручным запуском (manual).
3.  На стадии **staging** можно запустить задание и выкатить собранное и протестированное приложение на упрощенное окружение. Это могут делать разработчики, DevOps-инженеры, тестировщики. При этом для выката на окружения тестировщиков должны быть пройдены все тесты.
4.  После успешного прохождения тестов и выката на одно из окружений staging можно выкатить приложение в **pre-production** — это делают только тестировщики, DevOps-инженеры или релиз-инженеры.
5.  По мере накопления успешно протестированных фич релиз-инженер готовит новую версию и создаёт в репозитории **тег**. Пайплайн для тега отличается от пайплайна для ветки двумя дополнительными стадиями.
6.  После успешной сборки, тестов и выката в pre-production проводятся дополнительные ручные тесты новой версии, показ заказчику и другие «издевательства» над приложением. Если всё прошло успешно, то релиз-инженер запускает задание _**approve**_. Если что-то пошло не так, то релиз-инженер запускает задание _**not approve**_.
7.  Выкат приложения на **production** возможен только после успешного выката на pre-production и выполнения задания _approve_. Выкат на production может запустить релиз-инженер или DevOps-инженер.

https://habr.com/ru/company/flant/blog/332712/